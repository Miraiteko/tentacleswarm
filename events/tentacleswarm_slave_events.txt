namespace = tentacleswarm_slave
#0001天生奴隶
#0011成年礼物
#0021经典水井杀
#0031主动要求赐福
#0041被监禁者腐化
#1001奴隶健康崩溃事件
#4001生育事件

#天生奴隶成为真正的奴隶
tentacleswarm_slave.0001 = {
	type = character_event
	title = tentacleswarm_slave.0001.t
	desc = tentacleswarm_slave.0001.desc
	
	theme = seduction
	left_portrait = this
	
	widget = {
		gui = "event_window_widget_scheme"
		container = "custom_widgets_container"
	}
	trigger = {
		is_tentaclable_female = yes
		is_tentacle_slave = no
	}
	option = {
		name = tentacleswarm_slave.0001.a
		become_tentacle_slave = yes
		add_stress = massive_stress_loss
		
		ai_chance = {
			base = 100
			ai_accept_corrupt_modifier = yes
		}
	}
	option = {
		trigger = {
			is_tentacle_slave = no
		}
		show_as_unavailable = { 
			is_tentacle_slave = no
		}
		name = tentacleswarm_slave.refuse
		add_stress = massive_stress_gain
		
		ai_chance = {
			base = 100
			ai_reject_corrupt_modifier = yes
		}
	}
}
#来自监护人的特别的成年礼物
tentacleswarm_slave.0011 = {
	type = character_event
	title = tentacleswarm_slave.0011.t
	desc = tentacleswarm_slave.0011.desc
	theme = seduction
	left_portrait = this
	right_portrait = scope:guardian
	
	widget = {
		gui = "event_window_widget_scheme"
		container = "custom_widgets_container"
	}
	trigger = {
		is_female = yes
		fertility >= 0.1
	}
	option = {
		name = tentacleswarm_slave.0011.a
		trigger_event= {
			id = tentacleswarm_slave.0012
		}
	}
}
tentacleswarm_slave.0012 = {
	type = character_event
	title = tentacleswarm_slave.0012.t
	desc = tentacleswarm_slave.0012.desc
	theme = seduction
	left_portrait = {
		character = this
		animation = personality_zealous
	}
	
	right_portrait = scope:guardian
	
	widget = {
		gui = "event_window_widget_scheme"
		container = "custom_widgets_container"
	}
	option = {
		name = tentacleswarm_slave.0012.a
		become_tentacle_slave = yes
		tentacle_corrupt = yes
		add_stress = massive_stress_loss
		#知晓了监护人的秘密
		scope:guardian = {
			if = {
				limit = { is_hidden_tentacle_slave = yes }
				random_secret = {
					limit = { secret_type = secret_tentacle_slave }
					reveal_to = root
				}
			}
		}
		
		ai_chance = {
			base = 100
			ai_accept_corrupt_modifier = yes
		}
	}
	option = {
		show_as_unavailable = { 
			is_tentacle_slave = no
		}
		name = tentacleswarm_slave.refuse
		tentacle_corrupt = yes
		add_stress = massive_stress_gain
		#知晓了监护人的秘密
		scope:guardian = {
			if = {
				limit = { is_hidden_tentacle_slave = yes }
				random_secret = {
					limit = { secret_type = secret_tentacle_slave }
					reveal_to = root
				}
			}
		}
		
		ai_chance = {
			base = 100
			ai_reject_corrupt_modifier = yes
		}
	}
}
#水井杀
tentacleswarm_slave.0021 = {
	type = character_event
	title = tentacleswarm_slave.0021.t
	desc = tentacleswarm_slave.0021.desc
	
	theme = seduction
	left_portrait = this
	
	widget = {
		gui = "event_window_widget_scheme"
		container = "custom_widgets_container"
	}
	trigger = {
		is_tentaclable_female = yes
		is_baby_corrupted_tentacle_slave = no #怀孕且已经赐福的奴隶，不会被这个事件打扰
	}
	option = {
		name = tentacleswarm_slave.0021.a
		trigger_event= {
			id = tentacleswarm_slave.0022
		}
	}
}
tentacleswarm_slave.0022 = {
	type = character_event
	title = tentacleswarm_slave.0022.t	
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {
					is_tentacle_slave = yes
					is_pregnant = no
				}
				desc = tentacleswarm_slave.0022.desc1
			}
			triggered_desc = {
				trigger = {
					is_tentacle_slave = yes
					is_pregnant = yes
				}
				desc = tentacleswarm_slave.0022.desc2
			}
			triggered_desc = {
				trigger = {
					is_tentacle_slave = no
					is_pregnant = no
				}
				desc = tentacleswarm_slave.0022.desc3
			}
			triggered_desc = {
				trigger = {
					always = yes
				}
				desc = tentacleswarm_slave.0022.desc4
			}
		} 
	}
	theme = seduction
	left_portrait = {
		character = this
		animation = personality_zealous
	}
	
	widget = {
		gui = "event_window_widget_scheme"
		container = "custom_widgets_container"
	}
	option = {
		name = tentacleswarm_slave.0022.a
		tentacle_corruption_perk_add = yes
		if = {
			limit = { has_perk = tentacle_corruption_11_perk }
			add_stress = -100
		}
		else = {
			add_stress = -50
		}
		
		ai_chance = {
			base = 100
			ai_accept_corrupt_modifier = yes
		}
	}
	option = {
		trigger = {  
			NOT = { has_perk = tentacle_corruption_22_perk }
		}
		show_as_unavailable = {
			NOT = { has_perk = tentacle_corruption_31_perk }
			has_perk = tentacle_corruption_22_perk
		}
		name = tentacleswarm_slave.refuse
		tentacle_corrupt = yes
		show_as_tooltip = { 
			if = {
				limit = { has_perk = tentacle_corruption_11_perk }
				add_stress = 100 
			}
			else = {
				add_stress = 50
			}
		}
		random_list = {
			100 = {
	 			ai_accept_corrupt_modifier = yes
				tentacle_corruption_perk_add = yes
			}
			100 = {
				ai_reject_corrupt_modifier = yes
			}
		}
		hidden_effect = {
			if = {
				limit = { has_perk = tentacle_corruption_11_perk }
				add_stress = 100
			}
			else = {
				add_stress = 50
			}
		}
		ai_chance = {
			base = 100
			ai_reject_corrupt_modifier = yes
		}
	}
}

#要求赐福
tentacleswarm_slave.0031 = {
	type = character_event
	title = tentacleswarm_slave.0031.t
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {
					#初次奉献
					is_tentacle_slave = no 
					has_religion = religion:tentacleswarm_religion 
				}
				desc = tentacleswarm_slave.0031.desc
			}
			triggered_desc = {
				trigger = {
					always = yes
				}
				desc = tentacleswarm_slave.0031.desc1
			}
		}
	}
	theme = faith
	left_portrait = {
		character = this
		animation = personality_zealous
	}
	
	
	widget = {
		gui = "event_window_widget_scheme"
		container = "custom_widgets_container"
	}
	trigger = {
		is_tentaclable_female = yes
	}
	option = {
		name = tentacleswarm_slave.0031.a
		trigger_event= {
			id = tentacleswarm_slave.0032
		}
	}
}
tentacleswarm_slave.0032 = {
	type = character_event
	title = tentacleswarm_slave.0032.t
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {
					is_tentacle_slave = yes
					is_pregnant = no
				}
				desc = tentacleswarm_slave.0032.desc1
			}
			triggered_desc = {
				trigger = {
					is_tentacle_slave = yes
					is_pregnant = yes
				}
				desc = tentacleswarm_slave.0032.desc2
			}
			triggered_desc = {
				trigger = {
					is_tentacle_slave = no
					is_pregnant = no
				}
				desc = tentacleswarm_slave.0032.desc3
			}
			triggered_desc = {
				trigger = {
					always = yes
				}
				desc = tentacleswarm_slave.0032.desc4
			}
		}
	}
	theme = faith
	left_portrait = {
		character = root
		animation = happiness
	}
	
	widget = {
		gui = "event_window_widget_scheme"
		container = "custom_widgets_container"
	}
	option = {
		name = tentacleswarm_slave.0032.a
		become_tentacle_slave = yes
		tentacle_corrupt = yes
		add_stress = massive_stress_loss
		
		ai_chance = {
			base = 1000 #被赐福的情况下，更有可能接受
			ai_accept_corrupt_modifier = yes
		}
	}
	option = {
		trigger = {
			is_tentacle_slave = no
		}
		show_as_unavailable = { 
			is_tentacle_slave = no
		}
		name = tentacleswarm_slave.refuse
		tentacle_corrupt = yes
		add_stress = massive_stress_gain
		
		ai_chance = {
			base = 100
			ai_reject_corrupt_modifier = yes
		}
	}
}

#被囚禁者腐化
tentacleswarm_slave.0041 = {
	type = character_event
	title = tentacleswarm_slave.0041.t
	desc = tentacleswarm_slave.0041.desc
	theme = dungeon
	left_portrait = this
	right_portrait = scope:imprisoner
	
	widget = {
		gui = "event_window_widget_scheme"
		container = "custom_widgets_container"
	}
	trigger = {
		is_tentaclable_female = yes
	}  
	option = {
		name = tentacleswarm_slave.0041.a
		trigger_event = {
			id = tentacleswarm_slave.0042
		}
	}
}
tentacleswarm_slave.0042 = {
	type = character_event
	title = tentacleswarm_slave.0042.t
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {
					is_tentacle_slave = yes
					is_pregnant = no
				}
				desc = tentacleswarm_slave.0042.desc1
			}
			triggered_desc = {
				trigger = {
					is_tentacle_slave = yes
					is_pregnant = yes
				}
				desc = tentacleswarm_slave.0042.desc2
			}
			triggered_desc = {
				trigger = {
					is_tentacle_slave = no
					is_pregnant = no
				}
				desc = tentacleswarm_slave.0042.desc3
			}
			triggered_desc = {
				trigger = {
					always = yes
				}
				desc = tentacleswarm_slave.0042.desc4
			}
		}
	}
	theme = dungeon
	left_portrait = {
		character = this
		animation = personality_zealous
	}
	
	right_portrait = scope:imprisoner
	
	widget = {
		gui = "event_window_widget_scheme"
		container = "custom_widgets_container"
	}
	option = {
		name = tentacleswarm_slave.0042.a
		become_tentacle_slave = yes
		tentacle_corrupt = yes
		add_stress = massive_stress_loss
		
		ai_chance = {
			base = 100
			ai_accept_corrupt_modifier = yes
		}
	}
	option = {
		trigger = {
			is_tentacle_slave = no
		}
		show_as_unavailable = { 
			is_tentacle_slave = no
		}
		name = tentacleswarm_slave.refuse
		tentacle_corrupt = yes
		add_stress = massive_stress_gain
		
		ai_chance = {
			base = 100
			ai_reject_corrupt_modifier = yes
		}
	}
}
tentacleswarm_slave.1001 = {
	type = character_event
	title = tentacleswarm_slave.1001.t

	desc = tentacleswarm_slave.1001.desc

	left_portrait = {
		character = root
		animation = sick
	}
	theme = physical_health

	option = {
		name = {
			trigger = { has_trait = lazy }
			text = tentacleswarm_slave.1001.a.lazy
		}
		name = {
			trigger = { has_trait = lustful }
			text = tentacleswarm_slave.1001.a.lust
		}
		name = {
			text = tentacleswarm_slave.1001.a
		}

		if = {
			limit = { has_character_flag = immune_to_disease }
			remove_character_flag = immune_to_disease
		}
		
		add_trait = infirm

		stress_impact = {
			lazy = minor_stress_loss
			diligent = medium_stress_gain
			lustful = medium_stress_gain
		}
	}
}
#生育事件
tentacleswarm_slave.4001 = {
	type = character_event
	title = tentacleswarm_slave.4001.t
	desc =  {
		first_valid = {
			triggered_desc = {
				trigger = {
					is_tentacle_slave = yes
				}
				desc = tentacleswarm_slave.4001.desc1
			}
			triggered_desc = {
				trigger = {
					always = yes
				}
				desc = tentacleswarm_slave.4001.desc2
			}
		}
	}
	theme = seduction
	left_portrait = this
	
	widget = {
		gui = "event_window_widget_scheme"
		container = "custom_widgets_container"
	}
	trigger = {
		is_female = yes
		is_pregnant = yes
	}
	immediate = {
		#确认通知的配偶
		if = {
			limit = {
				exists = primary_partner
			}
			primary_partner = {
				save_scope_as = spouse
			}
		}
	}

	option = {
		name = tentacleswarm_slave.4001.default
		#结束妊娠
		end_pregnancy = yes
		pregnancy_cleanup_effect = yes
		custom_tooltip = tentacleswarm_suicide_tt
		
		#告知配偶
		if = {
			limit = {
				exists = scope:spouse
			}
			if = { #如果你信奉,配偶得到通知
				limit = {
					has_religion = religion:tentacleswarm_religion
				}
				#还没做
			}
			else = { #否则，配偶认为是流产
				scope:spouse = { trigger_event = pregnancy.2102 }
			}
		}

	}
}