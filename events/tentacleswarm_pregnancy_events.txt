namespace = tentacleswarm_pregnancy
#0001-0009月度结算
#1001-1031怀孕事件
#4001触手分娩

#月度结算
tentacleswarm_pregnancy.0001 = { #第一月没有效果
	hidden = yes
	immediate = {
		change_variable = {
			name = tentacle_pregnancy_month
			add = 1
		}
		trigger_event = {
			id = tentacleswarm_pregnancy.0002
			months = 1
		}
	}
}
tentacleswarm_pregnancy.0002 = { #第二月显露身孕
	hidden = yes
	immediate = {
		change_variable = {
			name = tentacle_pregnancy_month
			add = 1
		}
		add_trait = pregnant 
		trigger_event = {
			on_action = on_tentacle_pregnancy_mother #触发怀孕事件组
		}
		trigger_event = {
			id = tentacleswarm_pregnancy.0003
			months = 1
		}
	}
}
tentacleswarm_pregnancy.0003 = { #第三月
	hidden = yes
	immediate = {
		change_variable = {
			name = tentacle_pregnancy_month
			add = 1
		}
		trigger_event = {
			id = tentacleswarm_pregnancy.0004
			months = 1
		}
	}
}
tentacleswarm_pregnancy.0004 = { #第四月
	hidden = yes
	immediate = {
		change_variable = {
			name = tentacle_pregnancy_month
			add = 1
		}
		trigger_event = {
			id = tentacleswarm_pregnancy.0005
			months = 1
		}
	}
}
tentacleswarm_pregnancy.0005 = { #第五月
	hidden = yes
	immediate = {
		change_variable = {
			name = tentacle_pregnancy_month
			add = 1
		}
		trigger_event = {
			id = tentacleswarm_pregnancy.0006
			months = 1
		}
	}
}
tentacleswarm_pregnancy.0006 = { #第六月
	hidden = yes
	immediate = {
		change_variable = {
			name = tentacle_pregnancy_month
			add = 1
		}
		trigger_event = {
			id = tentacleswarm_pregnancy.0007
			months = 1
		}
	}
}
tentacleswarm_pregnancy.0007 = { #第七月触手分娩
	hidden = yes
	immediate = {
		change_variable = {
			name = tentacle_pregnancy_month
			add = 1
		}
		trigger_event = {
			id = tentacleswarm_pregnancy.4001
		}
	}
}
#怀孕事件
#正常怀孕
tentacleswarm_pregnancy.1001 = {
	title = tentacleswarm_pregnancy.1001.t
	desc = tentacleswarm_pregnancy.1001.d
	theme = pregnancy
	left_portrait = root

	trigger = {
		#触手宗教或公开触手奴隶
		OR = {
			has_religion = religion:tentacleswarm_religion
			has_trait = tentacle_slave
		}
	}

	immediate = {
		play_music_cue = "mx_cue_succession"
	}
	
	option = {
		add_trait_force_tooltip = pregnant
		name = tentacleswarm_pregnancy.1001.a
	}
}
#未婚先孕
tentacleswarm_pregnancy.1011 = { 
	title = tentacleswarm_pregnancy.1011.t
	desc = tentacleswarm_pregnancy.1011.desc
	theme = pregnancy
	left_portrait = root

	trigger = {
		#不信仰触手宗教
		#不是公开的触手奴隶
		NOR = {
			has_religion = religion:tentacleswarm_religion
			has_trait = tentacle_slave
		}
		#没有配偶
		NOT = {
			any_consort = {
				exists = this
			}
		}
	}

	immediate = {
		play_music_cue = "mx_cue_succession"
	}

	option = { #Publicly name the father!
		name = tentacleswarm_pregnancy.1011.a
		add_trait_force_tooltip = pregnant
		add_trait = tentacle_defiled #触手受害者
		add_adulterer_fornicator_trait_or_nothing_effect = yes #私通者
		ai_chance = {
			base = 20
			ai_value_modifier = {
				ai_honor = 0.5
				ai_boldness = 0.5
				ai_compassion = 0.25
			}
		}
	}

	option = { #Keep it secret!
		name = tentacleswarm_pregnancy.1011.b
		flavor = tentacleswarm_pregnancy.1011.b.tt
		add_trait_force_tooltip = pregnant
		add_adulterer_fornicator_trait_or_nothing_effect = yes #私通者
		ai_chance = {
			base = 100
			ai_value_modifier = {
				ai_rationality = 0.5
			}
		}
	}

	option = { #Attempt to terminate the pregnancy
		name = tentacleswarm_pregnancy.1031.c
		add_trait_force_tooltip = pregnant
		add_adulterer_fornicator_trait_or_nothing_effect = yes #私通者
		tentacle_pregnancy_termination_attempt_effect = yes 
		ai_chance = {
			base = 100
			ai_value_modifier = {
				ai_rationality = 0.5
			}
			modifier = { # Never hide the truth in faiths with the Polyamory tenet.
				factor = 0
				faith = { has_doctrine_parameter = no_unfaithfulness_penalty_active }
			}
		}
	}
}
#婚外孕育
tentacleswarm_pregnancy.1021 = {
	type = character_event
	title = tentacleswarm_pregnancy.1021.t
	desc = tentacleswarm_pregnancy.1021.desc
	theme = pregnancy
	left_portrait = ROOT
	right_portrait = scope:spouse
	
	trigger = {
		#不信仰触手宗教或者是公开奴隶
		NOR = {
			has_religion = religion:tentacleswarm_religion
			has_trait = tentacle_slave
		}
		#有男性配偶
		any_consort = {
			exists = this
			is_male = yes
		}
	}

	immediate = {
		play_music_cue = "mx_cue_succession"

		save_scope_as = mother
		hidden_effect = {	
			if = {
				limit = {
					exists = primary_partner
					primary_partner = { is_male = yes }
				}
				primary_partner = {
					save_scope_as = spouse
				}
			}
			else = {
				random_consort = {
					limit = { is_male = yes }
					save_scope_as = spouse
				}
			}
		}
	}

	option = { #Confess
		name = tentacleswarm_pregnancy.1021.a
		add_trait_force_tooltip = pregnant
		add_trait = tentacle_defiled #受害者
		add_adulterer_fornicator_trait_or_nothing_effect = yes #通奸者
		custom_tooltip = tentacleswarm_pregnancy.1021.a.tt
		ai_chance = {
			base = 0
		}
	}

	option = { #Keep it secret!
		name = tentacleswarm_pregnancy.1021.b
		custom_tooltip = tentacleswarm_pregnancy.1021.b.tt
		add_trait_force_tooltip = pregnant
		stress_impact = {
			honest = major_stress_impact_gain
		}
		ai_chance = {
			base = 100
			ai_value_modifier = {
				ai_rationality = 0.5
			}
		}
	}

	option = { #Attempt to get rid of the child
		name = tentacleswarm_pregnancy.1021.c
		add_trait_force_tooltip = pregnant
		tentacle_pregnancy_termination_attempt_effect = yes
		ai_chance = {
			base = 0
		}
	}
}
#同性婚育
tentacleswarm_pregnancy.1031 = {
	title = tentacleswarm_pregnancy.1031.t
	desc = tentacleswarm_pregnancy.1031.desc
	theme = pregnancy
	left_portrait = root

	trigger = {
		#不信仰触手宗教
		#不是公开的触手奴隶
		NOR = {
			has_religion = religion:tentacleswarm_religion
			has_trait = tentacle_slave
		}
		#没有男性配偶
		any_consort = {
			exists = this
		}
		NOT = {
			any_consort = {
				exists = this
				is_male = yes
			}
		}
	}

	immediate = {
		play_music_cue = "mx_cue_succession"
	}

	option = { #Publicly name the father!
		name = tentacleswarm_pregnancy.1031.a
		add_trait_force_tooltip = pregnant
		add_trait = tentacle_defiled #受害者
		add_adulterer_fornicator_trait_or_nothing_effect = yes #通奸者
		ai_chance = {
			base = 20
			ai_value_modifier = {
				ai_honor = 0.5
				ai_boldness = 0.5
				ai_compassion = 0.25
			}
		}
	}

	option = { #Keep it secret!
		name = tentacleswarm_pregnancy.1031.b
		add_trait_force_tooltip = pregnant
		flavor = tentacleswarm_pregnancy.1031.b.tt
		add_adulterer_fornicator_trait_or_nothing_effect = yes #通奸者
		ai_chance = {
			base = 100
			ai_value_modifier = {
				ai_rationality = 0.5
			}
		}
	}

	option = { #Attempt to terminate the pregnancy
		name = tentacleswarm_pregnancy.1031.c
		add_trait_force_tooltip = pregnant
		add_adulterer_fornicator_trait_or_nothing_effect = yes #通奸者
		tentacle_pregnancy_termination_attempt_effect = yes
		ai_chance = {
			base = 0
		}
	}
}
#生育事件
tentacleswarm_pregnancy.4001 = {
	type = character_event
	title = tentacleswarm_pregnancy.4001.t
	desc =  {
		first_valid = {
			triggered_desc = {
				trigger = {
					is_tentacle_slave = yes
				}
				desc = tentacleswarm_pregnancy.4001.desc1
			}
			triggered_desc = {
				trigger = {
					always = yes
				}
				desc = tentacleswarm_pregnancy.4001.desc2
			}
		}
	}
	theme = seduction
	left_portrait = this
	
	widget = {
		gui = "event_window_widget_scheme"
		container = "custom_widgets_container"
	}
	trigger = {
		is_female = yes
		is_tentacle_pregnant = yes
	}
	immediate = {
		#确认通知的配偶
		if = {
			limit = {
				exists = primary_partner
			}
			primary_partner = {
				save_scope_as = spouse
			}
		}
	}

	option = {
		name = tentacleswarm_pregnancy.4001.default
		#结束妊娠
		tentacle_end_pregnancy = yes
		
		#告知配偶
		if = {
			limit = {
				exists = scope:spouse
			}
			if = { #如果你信奉,配偶得到通知
				limit = {
					has_religion = religion:tentacleswarm_religion
				}
				#还没做
			}
			else = { #否则，配偶认为是流产
				scope:spouse = { trigger_event = pregnancy.2102 }
			}
		}

	}
}