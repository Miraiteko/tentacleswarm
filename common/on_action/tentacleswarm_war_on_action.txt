on_war_won_attacker = {
	on_actions = { 
		tentacleswarm_on_war_won_attacker
	}
}
on_war_won_defender = {
	on_actions = { 
		tentacleswarm_on_war_won_defender
	}
}
tentacleswarm_on_war_won_attacker = {
	trigger = {
	}
	effect = {
		#奴隶们战争进攻胜利释放4VA
		scope:attacker = {
			if = {
				limit = {
					has_religion = religion:tentacleswarm_religion
				}
				tentacleswarm_4VA = yes
			}
		} 
		#抗击剿灭失败，天灾阈值抬高/巢穴入侵成功，目标信仰无视度提高
		if = { 
			limit = {
				scope:war = {
					OR = {
						using_cb = tentacleswarm_religious_war 
						using_cb = tentacleswarm_conquest 
					}
				}
			}
			scope:defender = {
				faith = {
					if = { 
						limit = { has_variable = tentacleswarm_cap }
						change_variable = { name = tentacleswarm_cap add = 50 }	
					}
					else = {
						set_variable = { name = tentacleswarm_cap value = 800 }	
					}
				}
			}
		}
	}
}

tentacleswarm_on_war_won_defender = {
	effect = {
		#奴隶们战争防御胜利释放4VA
		scope:defender = {
			if = {
				limit = {
					has_religion = religion:tentacleswarm_religion
				}
				tentacleswarm_4VA = yes
			}
		} 
		#抗击剿灭胜利，天灾阈值降低/巢穴入侵成功，目标信仰无视度降低
		if = { 
			limit = {
				scope:war = {
					OR = {
						using_cb = tentacleswarm_religious_war 
						using_cb = tentacleswarm_conquest 
					}
				}
			}
			scope:defender = {
				faith = {
					if = { 
						limit = { has_variable = tentacleswarm_cap }
						change_variable = { name = tentacleswarm_cap multiply = 0.9 }	
					}
					else = {
						set_variable = { name = tentacleswarm_cap value = 800 }	
					}
				}
			}
		}
	}
}

on_war_started = {
    on_actions = {
        tentacleswarm_on_war_started
    }
}
#剿灭战争开始时，周围领主加入战争
tentacleswarm_on_war_started = {
	trigger = {
		scope:war = { using_cb = tentacleswarm_religious_war }
	}
    effect = { 
        scope:attacker  = {
            trigger_event = { 
                id = tentacleswarm_war.0001 #战争发动之后，周围的领主可以干预
            } 
        }
    }
}
