#核心判断
is_tentacle_slave = {
	custom_description = {
		text = is_tentacle_slave_tooltip
		has_character_flag = flag_tentacle_slave
	}
}
is_hidden_tentacle_slave = {
	custom_description = {
		text = is_hidden_tentacle_slave_tooltip
		any_secret = { secret_type = secret_tentacle_slave }
	}
}
is_tentacle_womb_corrupted = { #苗床
	custom_description = {
		text = is_tentacle_womb_corrupted_tooltip
		has_character_flag = flag_tentacle_womb_corrupted
	}
}
is_tentacle_body_corrupted = { #成瘾
	custom_description = {
		text = is_tentacle_body_corrupted_tooltip
		has_character_flag = flag_tentacle_body_corrupted
	}
}
#怀孕了但未被赐福判断
tentacle_baby_corruption_not_yet = {
	custom_description = {
		text = tentacle_baby_corruption_not_yet_tooltip
		AND = { 
			is_pregnant = yes
			has_character_flag = tentacle_baby_corruption_not_yet
		}
	}
}
#已经赐福的奴隶，她们不会再被袭击事件打扰
is_baby_corrupted_tentacle_slave = {
	is_tentacle_slave = yes #是奴隶
	is_pregnant = yes #已经怀孕了
	NOT = { has_character_flag = tentacle_baby_corruption_not_yet } #已经赐福了
}
#遗传判断
is_congenital_tentacle_slave = { #天生奴隶
	has_character_flag = congenital_tentacle_slave
}
is_congenital_tentacle_slave_carry = { #天生奴隶基因携带者
	has_character_flag = congenital_tentacle_slave_carry
	#has_trait = beauty_good_3
}

#触手奴隶罪行程度判断，用于在秘密机制中判断勒索等级
secret_tentacle_slave_is_shunned_trigger = {
	NOT = { has_religion = religion:tentacleswarm_religion } #信徒不在意
	OR = {
		faith = { has_doctrine_parameter = adultery_female_shunned }
		any_liege_or_above = { faith = { has_doctrine_parameter = adultery_female_shunned } }
	}
}
secret_tentacle_slave_is_criminal_trigger = {
	NOT = { has_religion = religion:tentacleswarm_religion } #信徒不在意
	OR = {
		faith = { has_doctrine_parameter = doctrine_tentacle_slave_evil }
		any_liege_or_above = { faith = { has_doctrine_parameter = doctrine_tentacle_slave_evil } }
		faith = { has_doctrine_parameter = adultery_female_crime }
		any_liege_or_above = { faith = { has_doctrine_parameter = adultery_female_crime } }
	}
}
secret_tentacle_slave_is_evil_trigger = {
	NOT = { has_religion = religion:tentacleswarm_religion } #信徒不在意
	OR = {
		faith = { has_doctrine_parameter = doctrine_tentacle_slave_evil }
		any_liege_or_above = { faith = { has_doctrine_parameter = doctrine_tentacle_slave_evil } }
	}
}
#是否是圣战
is_religious_war = {
	OR = {
		using_cb = minor_religious_war
		using_cb = religious_war
		using_cb = major_religious_war
		using_cb = excommunication_war
		using_cb = undirected_great_holy_war
		using_cb = directed_great_holy_war
		using_cb = tentacleswarm_conquest
		using_cb = tentacleswarm_religious_war
	}
}
using_non_ghw_holy_war_cb_trigger = {
	OR = {
		using_cb = minor_religious_war
		using_cb = religious_war
		using_cb = major_religious_war
		using_cb = tentacleswarm_conquest
		using_cb = tentacleswarm_religious_war
	}
}
#是否可以联盟均分继承
can_have_confederate_partition_succession_law_trigger = {
	OR = {
		has_government = feudal_government
		has_government = tribal_government
		has_government = clan_government
		has_government = tentacleswarm_government
	}
}
#勒索是否可以执行。覆盖原版条件，导致兼容性下降
is_blackmailable_secret_trigger = { #Should not include is known
	$PARTICIPANT$ = { save_temporary_scope_as = is_blackmailable_secret_participant }
	$BLACKMAILER$ = { save_temporary_scope_as = is_blackmailable_secret_blackmailer }
	is_shunned_or_criminal_for = scope:is_blackmailable_secret_participant
	can_be_exposed_by = scope:is_blackmailable_secret_blackmailer
	#Can we actually add a hook of the correct type
	trigger_if = {
		limit = { is_shunned_for = scope:is_blackmailable_secret_participant }
		custom_description = {
			text = "already_has_a_superior_hook"
			subject = scope:is_blackmailable_secret_blackmailer
			object = scope:is_blackmailable_secret_participant
			scope:is_blackmailable_secret_blackmailer = {
				can_add_hook = {
					type = weak_blackmail_hook
					target = scope:is_blackmailable_secret_participant
				}
			}
		}
	}
	trigger_if = {
		limit = { is_criminal_for = scope:is_blackmailable_secret_participant }
		custom_description = {
			text = "already_has_a_superior_hook"
			subject = scope:is_blackmailable_secret_blackmailer
			object = scope:is_blackmailable_secret_participant
			scope:is_blackmailable_secret_blackmailer = {
				can_add_hook = {
					type = strong_blackmail_hook
					target = scope:is_blackmailable_secret_participant
				}
			}
		}
	}
	#If an AI promised not to reveal a secret they have to be very dishonest to do it
	trigger_if = {
		limit = { exists = var:promised_not_to_reveal}
		custom_description = {
			text = "promised_not_to_reveal_secret"
			var:promised_not_to_reveal = scope:is_blackmailable_secret_blackmailer
			scope:is_blackmailable_secret_blackmailer = {
				is_ai = yes
				ai_honor >= medium_negative_ai_value
			}
		}
	}
	
	#Some things you can't blackmail others about
	custom_description = {
		text = "cant_blackmail_another_witch"
		subject = scope:is_blackmailable_secret_blackmailer
		NAND = {
			secret_type = secret_witch
			scope:is_blackmailable_secret_blackmailer = { is_witch_trigger = yes }
		}
	}
	custom_description = { #不能勒索其他触手奴隶
		text = "cant_blackmail_another_tentacle_slave"
		subject = scope:is_blackmailable_secret_blackmailer
		NAND = {
			secret_type = secret_tentacle_slave
			scope:is_blackmailable_secret_blackmailer = { is_tentacle_slave = yes }
		}
	}
	trigger_if = {
		limit = { secret_type = secret_lover }
		custom_description = {
			text = cannot_blackmail_own_lover_secret
			NOT = { secret_target = scope:is_blackmailable_secret_blackmailer }
		}
	}
	trigger_if = {
		limit = {
			secret_type = secret_unmarried_illegitimate_child
		}
		custom_description = {
			text = cannot_blackmail_over_own_bastard
			secret_target = {
				NOR = {
					mother = scope:is_blackmailable_secret_blackmailer
					real_father = scope:is_blackmailable_secret_blackmailer
				}
			}
		}
	}
	trigger_if = {
		limit = {
			secret_type = secret_disputed_heritage
		}
		custom_description = {
			text = cannot_blackmail_over_own_bastard
			NOT = {
				secret_target = {
					OR = {
						mother = scope:is_blackmailable_secret_blackmailer
						real_father = scope:is_blackmailable_secret_blackmailer
					}
				}
			}
		}
	}
}
